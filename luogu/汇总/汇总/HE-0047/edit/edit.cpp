#include<bits/stdc++.h>

using namespace std;

int n,as;
string a,b,c,d;
int g[2][3];

void sol(){
	memset(g,0,sizeof(g));
	as=0;
	cin>>n>>a>>b>>c>>d;
	a=" "+a;
	b=" "+b;
	c=" "+c+"0";
	d=" "+d+"0";
	g[0][1]=g[0][0]=g[1][0]=g[1][1]=0;
	int tp1=1,tp2=1;
	for(int i=1;i<=n;++i){
		while(tp1<i){
			g[0][a[tp1]-'0']++;
			++tp1;
		}while(tp2<i){
			g[1][b[tp2]-'0']++;
			++tp2;
		}
		if(c[i]=='0'&&d[i]=='0'){
			tp1=tp2=i+1;
//			cout<<"                         "<<"3\n";
			if(a[i]==b[i]){
				as++;
			}as+=min(g[0][1],g[1][1])+min(g[0][0],g[1][0]);
			g[0][0]=g[0][1]=g[1][0]=g[1][1]=0;
		}else if(c[i]=='0'){
			while(d[tp2]=='1'&&tp2<=n){
				g[1][b[tp2]-'0']++;
				++tp2;
			}g[0][a[tp1++]-'0']++;
			as+=min(g[0][1],g[1][1])+min(g[0][0],g[1][0]);
//			cout<<"          1 "<<i<<" "<<tp1<<" "<<tp2<<"     "<<g[0][0]<<" "<<g[0][1]<<"   "<<g[1][0]<<" "<<g[1][1]<<"     \n";
			if(g[1][1]>=g[0][1]){
				g[1][1]-=g[0][1];
				g[0][1]=0;
			}else{
				g[1][0]-=g[0][1]-g[1][1];
				g[1][1]=0;
				g[0][1]=0;
			}if(g[1][0]>=g[0][0]){
				g[1][0]-=g[0][0];
				g[0][0]=0;
			}else{
				g[1][1]-=g[0][0]-g[1][0];
				g[1][0]=0;
				g[0][0]=0;
			}g[0][0]=g[0][1]=0;
		}else if(d[i]=='0'){
			while(c[tp1]=='1'&&tp1<=n){
				g[0][a[tp1]-'0']++;
				++tp1;
			}g[1][b[tp2++]-'0']++;
			as+=min(g[0][1],g[1][1])+min(g[0][0],g[1][0]);
//			cout<<"          2 "<<i<<" "<<tp1<<" "<<tp2<<"     "<<g[0][0]<<" "<<g[0][1]<<"   "<<g[1][0]<<" "<<g[1][1]<<"\n";
			if(g[0][1]>=g[1][1]){
				g[0][1]-=g[1][1];
				g[1][1]=0;
			}else{
				g[0][0]-=g[1][1]-g[0][1];
				g[0][1]=0;
				g[1][1]=0;
			}if(g[0][0]>=g[1][0]){
				g[0][0]-=g[1][0];
				g[1][0]=0;
			}else{
				g[0][1]-=g[1][0]-g[0][0];
				g[0][0]=0;
				g[1][0]=0;
			}g[1][0]=g[1][1]=0;
		}
	}
	
//	cout<<"            "<<" "<<tp1<<" "<<tp2<<" "<<g[0][0]<<" "<<g[0][1]<<" "<<g[1][0]<<" "<<g[1][1]<<"\n";

	while(tp1<=n){
		g[0][a[tp1]-'0']++;
		++tp1;
	}while(tp2<=n){
		g[1][b[tp2]-'0']++;
		++tp2;
	}
	as+=min(g[0][1],g[1][1])+min(g[0][0],g[1][0]);
	cout<<as<<"\n";
}

int main(){
	freopen("edit.in","r",stdin);
	freopen("edit.out","w",stdout);
	int T;
	cin>>T;
//	T=3;
	while(T--){
		sol();
	}
	return 0;
}
/*
1
6
111111
111010
011011
111100

*/
